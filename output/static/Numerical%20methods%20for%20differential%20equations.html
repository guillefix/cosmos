<h3 class=""><strong><a class="tc-tiddlylink tc-tiddlylink-resolves" href="#Initial%20value%20problem">Initial value problem</a></strong>s (IVP) for <u>ordinary differential equation</u> (ODE) </h3><p>In  standard form</p><p><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>u</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>=</mo><mi>f</mi><mo>(</mo><mi>u</mi><mo separator="true">,</mo><mi>t</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">u&#x27; = f(u,t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">u</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">u</span><span class="mpunct">,</span><span class="mord mathit">t</span><span class="mclose">)</span></span></span></span></span></p><p>could represent system of equations (i.e. <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">u</span></span></span></span></span> vector).</p><p>Discretize time in steps of size <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span></span> (<em>timestep</em>).</p><p>Numerical methods (<em>finite difference discretization</em> methods, similar to <a class="tc-tiddlylink tc-tiddlylink-resolves" href="#Finite%20element%20method">Finite element method</a>s):</p><ul><li><strong><a class="tc-tiddlylink-external" href="http://web.mit.edu/16.90/BackUp/www/pdfs/Chapter10.pdf" rel="noopener noreferrer" target="_blank">Multi-stage</a></strong>. <strong><a class="tc-tiddlylink tc-tiddlylink-resolves" href="#Runge-Kutta%20methods">Runge-Kutta methods</a></strong>: 1 step, i.e. only neighbouring grid points.<ul><li><a class="tc-tiddlylink tc-tiddlylink-resolves" href="#Euler%20method">Euler method</a></li><li><a class="tc-tiddlylink tc-tiddlylink-resolves" href="#Modified%20Euler%20method">Modified Euler method</a>. Accuracy <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><msup><mi>k</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(k^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span></span></li><li>Fourth order Runge-Kutta. Accuracy <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><msup><mi>k</mi><mn>4</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(k^4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">4</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span></span></li></ul></li><li><strong><a class="tc-tiddlylink-external" href="http://web.mit.edu/16.90/BackUp/www/pdfs/Chapter4.pdf" rel="noopener noreferrer" target="_blank">Multi-step</a></strong>. <strong><a class="tc-tiddlylink tc-tiddlylink-resolves" href="#Multi-step%20method">Adams-Bashforth</a></strong>. Uses points n steps away in grid. Drawback: they are tricky to start up because extra values are needed.<ul><li>1st order. Called (forward) <a class="tc-tiddlylink-external" href="https://en.wikipedia.org/wiki/Euler_method#Formulation_of_the_method" rel="noopener noreferrer" target="_blank">Euler formula</a>. Accuracy <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mi>k</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">O(k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></span></li><li>2nd order. Accuracy <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><msup><mi>k</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(k^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span></span></li><li>etc.</li></ul></li></ul><p>All of these methods have <a class="tc-tiddlylink-external" href="https://www.wikiwand.com/en/Explicit_and_implicit_methods" rel="noopener noreferrer" target="_blank">explicit and implicit variants</a></p><p><u>IVP codes in MATLAB</u></p><p><code>ode23</code>: low-order RK
<code>ode45</code>: higher-order RK
<code>ode113</code>: variable-order multistep
<code>ode23s</code>, <code>ode15s</code>, <code>ode15i</code>, <code>ode23t</code>, <code>ode23tb</code> variants for stiff problems etc.</p><p>In <strong><a class="tc-tiddlylink-external" href="http://www.chebfun.org/" rel="noopener noreferrer" target="_blank">Chebfun</a></strong></p><p><code>N = chebop(a,b)</code>       % define the interval [a,b]</p><p><code>N.op = @(x,u) ...</code>     % define the ODE, with diff(u,k) = kth derivative of u</p><p><code>N.bc = ...</code>            % boundary conditions</p><h3 class=""><u><a class="tc-tiddlylink-external" href="https://www0.maths.ox.ac.uk/system/files/coursematerial/2015/2203/7/2.pdf" rel="noopener noreferrer" target="_blank">Order of accuracy</a>, convergence, stability, etc.</u></h3><p>See <a class="tc-tiddlylink-external" href="http://web.mit.edu/16.90/BackUp/www/pdfs/Chapter3.pdf" rel="noopener noreferrer" target="_blank">here</a> for explanation of <strong>local truncation error</strong> (LTE), used to find <em>order of accuracy</em> (what we call accuracy above, <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><msup><mi>k</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(k^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span></span>,  i.e. error decreases with the square of the time step.</p><p><strong>Convergence</strong> and <strong>Stability</strong></p><p>Theory of convergence of multistep formulas by Dahlquist (1956). Analogs for RK too.</p><p>Key definitions:</p><p><strong>consistent</strong>: order of accuracy &gt; 1.</p><p><strong>stable</strong>: if for f(t,u) = 0 all the solutions are bounded.. I.e. does error grow or stay bounded.. See <a class="tc-tiddlylink-external" href="http://web.mit.edu/16.90/BackUp/www/pdfs/Chapter5.pdf" rel="noopener noreferrer" target="_blank">here</a> too.</p><p><strong>convergent</strong>:  <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mo>→</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">v\rightarrow u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mrel">→</span><span class="mord mathit">u</span></span></span></span></span> for each fixed <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.61508em;"></span><span class="strut bottom" style="height:0.61508em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">t</span></span></span></span></span> as <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">k \rightarrow 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">→</span><span class="mord mathrm">0</span></span></span></span></span> (ignoring rounding errors, from computing..).</p><p><strong>Dahlquist equivalence theorem</strong>:</p><table><tbody><tr class="evenRow"><td>Convergence <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>⇔</mo></mrow><annotation encoding="application/x-tex">\Leftrightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.36687em;"></span><span class="strut bottom" style="height:0.36687em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mrel">⇔</span></span></span></span></span> consistency <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>+</mo></mrow><annotation encoding="application/x-tex">+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">+</span></span></span></span></span> stability</td></tr></tbody></table><p>The Adams formulas are consistent and stable, hence convergent</p><p>Adaptive ODE codes adapt step size and other parameters so that estimated errors (using methods above, like LTE) are smaller than a prescribed value.</p><p><u><a class="tc-tiddlylink tc-tiddlylink-resolves" href="#Chaos%20theory">Chaos</a></u> and <u><a class="tc-tiddlylink tc-tiddlylink-missing" href="#Lyapunov%20exponents">Lyapunov exponents</a></u>. The <a class="tc-tiddlylink tc-tiddlylink-missing" href="#Lorenz%20equations">Lorenz equations</a>. Sinai billiards is another famous chaotic system.</p><p><u><a class="tc-tiddlylink-external" href="https://www0.maths.ox.ac.uk/system/files/coursematerial/2015/2203/13/4.pdf" rel="noopener noreferrer" target="_blank">Stability regions</a></u> regions of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">ka</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mord mathit">a</span></span></span></span></span> space (<span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">a</span></span></span></span></span> is a parameter in the model ode, a=0 corresponds to f=0, as defined above for stability, I guess here we are being more general..) in which solutions remain bounded (this is achieved when characteristic polynomial of the recurrence relation, obtained by the finite difference method, has roots with <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><mi>r</mi><mi mathvariant="normal">∣</mi><mo>≤</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|r| \leq 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">∣</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathrm">∣</span><span class="mrel">≤</span><span class="mord mathrm">1</span></span></span></span></span> and any root <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><mi>r</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|r|=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">∣</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathrm">∣</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span></span> is simple). See <a class="tc-tiddlylink-external" href="http://web.mit.edu/16.90/BackUp/www/pdfs/Chapter5.pdf" rel="noopener noreferrer" target="_blank">here</a> too.</p><p><strong>Stiffness</strong>. A stiff ODE is one with widely varying time scales. One may need very small <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span></span> because there are modes with <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">ka</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mord mathit">a</span></span></span></span></span> (i.e. part of equation which create behaviour corresponding to certain <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">a</span></span></span></span></span> value) outside stability region, even if our solution of interest has effective <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">ka</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mord mathit">a</span></span></span></span></span> inside it.</p><p>This is manifested as our solution changing on a long timescale, but depending on short time-scale terms in equation.</p><p>Solution: backward-differentiation formulas, or <strong>implicit formulas</strong>, that include <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><msub><mi>v</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>t</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">f(v_{n+1}, t_{n+1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span></span>, unlike explicit formulas. (<a class="tc-tiddlylink tc-tiddlylink-resolves" href="#Implicit%20numerical%20method">Implicit numerical method</a>)</p><p>These require solving a (generally) nonlinear equation (or a system of equations for PDEs). And this may need to be solved numerically itself often, for example by Newton's method.</p><hr><p><em>Aside.</em> We've been discussing IVPs here only.</p><p><strong>Boundary value problems</strong> (BVP) also important. Nonlinear BVP may not have unique solutions! (unlike IVP).</p><p>Can use chebfun to solve.</p><hr><h2 class=""><u><a class="tc-tiddlylink tc-tiddlylink-resolves" href="#Numerical%20methods%20for%20PDEs">Numerical methods for PDEs</a></u></h2><ul><li><a class="tc-tiddlylink tc-tiddlylink-resolves" href="#Finite%20element%20method">Finite element method</a>s for complex geometries</li><li><a class="tc-tiddlylink tc-tiddlylink-missing" href="#Finite%20volume%20method">Finite volume method</a>s for <a class="tc-tiddlylink tc-tiddlylink-resolves" href="#Hyperbolic%20geometry">Hyperbolic geometry</a></li><li><a class="tc-tiddlylink tc-tiddlylink-resolves" href="#Finite%20difference%20method">Finite difference method</a> for simple geometry.</li></ul><hr><p><em>Books</em>:</p><p>Griffiths &amp; Higham, 2010 - introduction to numerical ODE</p><p>Iserles, 2009 - includes connection to PDEs</p><p>LeVeque, 2007 - likewise</p><p>Hairer, Norsett &amp; Wanner I &amp; II - authoritative; full of fun and historical remarks</p><p>Ascher &amp; Petzold 1998 - also includes DAEs (differential-algebraic equations,
which combine ODEs and nonlinear eqs)</p><p>Deuflhard &amp; Bornemann, 2002</p><p>Trefethen, old online textbook (<a class="tc-tiddlylink-external" href="http://people.maths.ox.ac.uk/trefethen/pdetext.html" rel="noopener noreferrer" target="_blank">http://people.maths.ox.ac.uk/trefethen/pdetext.html</a>)
</p>